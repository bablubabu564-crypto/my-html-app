<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Neon Cyberpunk Racer - Bablu</title>
  <meta name="theme-color" content="#06060a">
  <link rel="manifest" href="manifest.json">
  <style>
    :root{--bg:#06060a;--neon-pink:#ff2d95;--neon-cyan:#00e6ff;--track:#0b0b12}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#e6eef8}
    .game-wrap{width:100%;max-width:1100px;height:700px;margin:20px auto;display:grid;grid-template-columns:1fr 320px;gap:18px;padding:20px;box-sizing:border-box}
    .stage{background:linear-gradient(180deg,var(--track),#050509);border-radius:16px;padding:12px}
    canvas{width:100%;height:100%;display:block;background:linear-gradient(180deg,#05050a,#080812);border-radius:12px}
    .ui{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;padding:18px}
    h1{font-size:20px;margin:0 0 12px 0;color:var(--neon-pink);text-shadow:0 0 14px rgba(255,45,149,0.25)}
    .stat{display:flex;gap:8px;align-items:center;margin-bottom:10px}
    .meter{height:12px;background:rgba(255,255,255,0.03);border-radius:8px;overflow:hidden;flex:1}
    .meter > i{display:block;height:100%;background:linear-gradient(90deg,var(--neon-cyan),var(--neon-pink));width:20%}
    .controls{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:12px}
    .btn{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.03);padding:10px;border-radius:12px;text-align:center;cursor:pointer;user-select:none}
    .big-btns{display:flex;gap:8px;margin-top:14px}
    .big{flex:1;padding:14px;border-radius:12px;font-weight:700;background:linear-gradient(90deg, rgba(0,230,255,0.06), rgba(255,45,149,0.06));}
    .legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{padding:6px 8px;border-radius:999px;background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));border:1px solid rgba(255,255,255,0.02);font-size:13px}
    @media(max-width:980px){.game-wrap{grid-template-columns:1fr;grid-auto-rows:auto;height:calc(100vh - 40px)}; .ui{order:2}}
  </style>
</head>
<body>
  <div class="game-wrap">
    <div class="stage"><canvas id="gameCanvas" width="800" height="676"></canvas></div>
    <div class="ui">
      <h1>Neon Cyberpunk Racer — Bablu</h1>
      <div class="stat"><strong>Speed</strong><div class="meter" id="speedMeter"><i style="width:10%"></i></div><div id="speedVal" style="width:56px;text-align:right">0</div></div>
      <div class="stat"><strong>Boost</strong><div class="meter" id="boostMeter"><i style="width:0%"></i></div><div id="boostVal" style="width:56px;text-align:right">0</div></div>
      <div class="controls">
        <div class="btn" id="leftBtn"><span class="label">Left</span><span class="key">← / A</span></div>
        <div class="btn" id="rightBtn"><span class="label">Right</span><span class="key">→ / D</span></div>
        <div class="btn" id="accelBtn"><span class="label">Accelerate</span><span class="key">↑ / W</span></div>
        <div class="btn" id="brakeBtn"><span class="label">Brake</span><span class="key">↓ / S</span></div>
      </div>
      <div class="big-btns"><div class="btn big" id="boostBtn">BOOST (Space)</div></div>
      <div class="legend"><div class="chip">Touch <span style="color:#ff6b6b;font-weight:700">RED</span> = slows you</div><div class="chip">Touch <span style="color:#6bff9a;font-weight:700">GREEN</span> = boost</div><div class="chip">Steer with keyboard or buttons</div></div>
      <div class="footer" style="font-size:12px;color:#aacbd6;opacity:0.9;margin-top:14px">Tip: Add to Home Screen to make it installable (PWA)</div>
    </div>
  </div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const W = canvas.width; const H = canvas.height;
  const player = { x: W/2, y: H - 120, w: 28, h: 42, angle: 0, speed: 2.2, maxSpeed: 9, minSpeed: 0.7, accel: 0.18, friction: 0.02, colorA: '#00e6ff', colorB: '#ff2d95' };
  let keys = {left:false,right:false,up:false,down:false,boost:false};
  const pads = []; const PAD_TYPES = {RED:'red', GREEN:'green'};
  const lanes = 5; const laneW = W / lanes;
  let boostReserve = 0; let boostActive = 0; let spawnTimer = 0;
  function spawnPad(){ const lane = Math.floor(Math.random()*lanes); const t = Math.random() < 0.18 ? PAD_TYPES.GREEN : PAD_TYPES.RED; const padW = laneW * 0.85; pads.push({x: lane*laneW + laneW*0.075, y: -60, w: padW, h: 30, type: t}); }
  function update(){
    if(keys.left){ player.x -= 4 + player.speed*0.12; player.angle = -0.25; }
    else if(keys.right){ player.x += 4 + player.speed*0.12; player.angle = 0.25; }
    else { player.angle *= 0.85; }
    if(keys.up){ player.speed += player.accel; }
    if(keys.down){ player.speed -= player.accel*1.1; }
    if(keys.boost && boostReserve >= 15){ boostActive = 35; boostReserve -= 15; }
    if(boostActive>0){ player.speed += 0.6; boostActive--; }
    if(player.speed > player.maxSpeed) player.speed = player.maxSpeed;
    if(player.speed < -1) player.speed = -1;
    player.speed -= player.friction * (1 + player.speed*0.02);
    if(player.speed < player.minSpeed) player.speed = player.minSpeed;
    for(let p of pads){ p.y += player.speed*4; }
    spawnTimer -= player.speed*0.6;
    if(spawnTimer <= 0){ spawnPad(); spawnTimer = 70 + Math.random()*80; }
    for(let i = pads.length-1; i>=0; i--){
      const p = pads[i];
      const px = player.x; const py = player.y - player.h/2;
      if(p.y + p.h > py - 10 && p.y < py + player.h && px > p.x - 10 && px < p.x + p.w + 10){
        if(p.type === PAD_TYPES.RED){ player.speed -= 1.6; if(player.speed < player.minSpeed) player.speed = player.minSpeed; shake = 12; }
        else if(p.type === PAD_TYPES.GREEN){ boostReserve += 28; if(boostReserve > 100) boostReserve = 100; boostActive += 16; pop = 18; }
        pads.splice(i,1);
      } else if(p.y > H + 120) pads.splice(i,1);
    }
    const margin = 40; if(player.x < margin) player.x = margin; if(player.x > W - margin) player.x = W - margin;
    if(boostReserve < 100 && Math.random() < 0.02) boostReserve += 0.2;
    document.getElementById('speedVal').innerText = Math.round(player.speed*10)/10;
    document.getElementById('speedMeter').firstElementChild.style.width = Math.min(100, Math.abs(player.speed)/player.maxSpeed*100) + '%';
    document.getElementById('boostVal').innerText = Math.round(boostReserve);
    document.getElementById('boostMeter').firstElementChild.style.width = boostReserve + '%';
  }

  let shake = 0; let pop = 0;
  function draw(){
    ctx.clearRect(0,0,W,H);
    const g = ctx.createLinearGradient(0,0,0,H); g.addColorStop(0,'#061018'); g.addColorStop(1,'#030306'); ctx.fillStyle = g; ctx.fillRect(0,0,W,H);
    for(let i=0;i<12;i++){ ctx.fillStyle = i%2? 'rgba(255,45,149,0.03)':'rgba(0,230,255,0.02)'; const bx = i*(W/12)+ (Math.sin(Date.now()/700 + i)*6); const bh = 60 + (i%3)*20; ctx.fillRect(bx, H-120-bh, 30, bh); }
    for(let i=0;i<=lanes;i++){ const x = i*laneW; ctx.fillStyle = 'rgba(255,255,255,0.02)'; ctx.fillRect(x, 40, 2, H-140); }
    for(let p of pads){ ctx.save(); if(p.type === PAD_TYPES.RED){ ctx.shadowColor = 'rgba(255,80,80,0.9)'; ctx.shadowBlur = 18; ctx.fillStyle = 'rgba(255,80,80,0.95)'; } else { ctx.shadowColor = 'rgba(120,255,170,0.9)'; ctx.shadowBlur = 18; ctx.fillStyle = 'rgba(120,255,170,0.95)'; } roundRect(ctx, p.x, p.y, p.w, p.h, 8, true, false); ctx.restore(); }
    ctx.save(); ctx.fillStyle = 'rgba(0,0,0,0.35)'; ctx.fillRect(0, H-140, W, 200); ctx.restore();
    ctx.save(); ctx.translate(player.x, player.y + 8 + (shake? Math.random()*shake:0)); ctx.rotate(player.angle); ctx.beginPath(); ctx.moveTo(0, -player.h/1.6); ctx.lineTo(-player.w/2, player.h/2); ctx.lineTo(player.w/2, player.h/2); ctx.closePath(); ctx.shadowBlur = 26; ctx.shadowColor = 'rgba(0,230,255,0.14)'; const grad = ctx.createLinearGradient(-player.w, -player.h, player.w, player.h); grad.addColorStop(0, player.colorA); grad.addColorStop(1, player.colorB); ctx.fillStyle = grad; ctx.fill(); ctx.restore();
    if(pop>0){ ctx.save(); ctx.globalAlpha = Math.min(1, pop/18); ctx.fillStyle = 'rgba(120,255,170,0.08)'; ctx.fillRect(0,0,W,H); ctx.restore(); pop -= 0.8; }
    if(shake>0) shake -= 0.6;
  }
  function loop(){ update(); draw(); requestAnimationFrame(loop); }
  function roundRect(ctx,x,y,w,h,r,fill,stroke){ if(typeof r==='undefined') r=5; ctx.beginPath(); ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r); ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r); ctx.closePath(); if(fill)ctx.fill(); if(stroke)ctx.stroke(); }
  window.addEventListener('keydown', e=>{ if(e.key === 'ArrowLeft' || e.key==='a' || e.key==='A') keys.left = true; if(e.key === 'ArrowRight' || e.key==='d' || e.key==='D') keys.right = true; if(e.key === 'ArrowUp' || e.key==='w' || e.key==='W') keys.up = true; if(e.key === 'ArrowDown' || e.key==='s' || e.key==='S') keys.down = true; if(e.code === 'Space') keys.boost = true; });
  window.addEventListener('keyup', e=>{ if(e.key === 'ArrowLeft' || e.key==='a' || e.key==='A') keys.left = false; if(e.key === 'ArrowRight' || e.key==='d' || e.key==='D') keys.right = false; if(e.key === 'ArrowUp' || e.key==='w' || e.key==='W') keys.up = false; if(e.key === 'ArrowDown' || e.key==='s' || e.key==='S') keys.down = false; if(e.code === 'Space') keys.boost = false; });
  const btnMap = {leftBtn: 'left', rightBtn:'right', accelBtn:'up', brakeBtn:'down', boostBtn:'boost'};
  for(const id in btnMap){ const el = document.getElementById(id); if(!el) continue; const keyName = btnMap[id]; el.addEventListener('pointerdown', ()=>{ keys[keyName]=true; el.classList.add('active'); }); ['pointerup','pointerout','pointercancel'].forEach(ev=> el.addEventListener(ev, ()=>{ keys[keyName]=false; el.classList.remove('active'); })); }
  function fixHiDPI(){ const dpr = window.devicePixelRatio || 1; canvas.width = W * dpr; canvas.height = H * dpr; canvas.style.width = W + 'px'; canvas.style.height = H + 'px'; ctx.setTransform(dpr,0,0,dpr,0,0); }
  fixHiDPI(); window.addEventListener('resize', ()=> fixHiDPI());
  for(let i=0;i<6;i++) spawnPad();
  player.speed = 2.2;
  loop();
})();</script>
</body>
</html>
